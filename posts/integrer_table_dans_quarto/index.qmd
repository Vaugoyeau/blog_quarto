---
title: "Int√©grer une table dans un document `Quarto`"
author: "Marie Vaugoyeau"
date: "2025/04/29"
date-format: "D MMMM YYYY"
categories: [twitch, Rnewbies, analyse de donn√©es, statistiques, quarto]
toc: true
toc-title: Sur cette page
---

[![](table.png){fig-align="center"}](https://500px.com/p/antoinemach?view=photos)

::: {.callout-note icon="false"}
[**Twitch du 29 avril 2025**](https://www.twitch.tv/videos/2445732164).\

Code disponible sur [GitHub](https://github.com/Vaugoyeau/twitch_integrer_table_dans_quarto).
:::

# C'est quoi Quarto ?

![](https://quarto.org/quarto.png){width=50%}  

`Quarto` est un syst√®me d'√©dition de code qui fait la part belle √† la documentation.  
Pour en savoir plus, rendez-vous sur la page du [guide de Quarto](https://quarto.org/docs/guide/).  
Pour s'initier √† Quarto gr√¢ce √† une vid√©o d'une heure, rendez-vous [ici](https://www.twitch.tv/videos/1941574357) et pour apprendre √† r√©aliser un article scientifique en Quarto c'est [l√†](https://www.twitch.tv/videos/2408949837)  
  
  
# Int√©grer une table interactive  
Pour int√©grer une table interactive, j'utilise le package `{DT}`.  
  

::: {.callout-tip}
## `{DT}`  

Le [package `{DT}`](https://rstudio.github.io/DT/) permet de r√©aliser des tables interactives au format `html`.  
  
**Attention** : Comme les tables sont au format `html` il n'est pas possible de les incorporer dans un fichier non dynamique comme un `.pdf` ou `.docx`.  
  
Ces tables peuvent-√™tre jointes √† un rapport `html` quarto ou une appli `Shiny`.   
:::  
  
::: {.callout-important}
La fonction principale est `datatable()` √† ne pas confondre avec `data.table()` du package `{data.table}`.  
:::
  
## Personnaliser une table  
L'utilisation du package `{DT}` se fait en param√©trant les arguments dans la fonction principale.  
  
```{r}
library(DT)
```

```{r}
iris |> 
  datatable()

```
  
Choisir le nombre de ligne √† afficher gr√¢ce √† l'option `pageLength`.  
  
```{r}
iris  |>
  datatable(
    options = list(pageLength = 5)
  )
```

Afficher uniquement ce qui est n√©cessaire gr√¢ce √† l'argument `dom`.     
```{r}
iris  |>
  datatable(
    options = list(
      pageLength = 5,
      dom = "pfti" # i = information, f = filtre, p = pagination, t = table
    )
  )
```
  
Plus d'informations sur les [options](https://datatables.net/reference/option/).  
  
## Modifier l'aspect de la table      
Il existe dans `{DT}` des styles css pr√©d√©finis et applicables gr√¢ce √† l'argument `class` qui peut prendre comme valeurs :   

- `cell-border` : pour une bordure pleine des cellules  
- `compact` : r√©duit les espaces entre les lignes  
- `hover` : mise en avant de la ligne lors du survol du curseur  
- `nowrap` : pour supprimer les retours √† la ligne dans les cellules  
- `order-column` : mise en √©vidence de la colonne selon laquelle est tri√©e la table  
- `row-border` : pour une bordure uniquement en haut et en bas des colonnes (ne peut √™tre utilis√© en m√™me temps que cell-border pour des raisons √©videntes)  
- `stripe` : pour des lignes ‚Äúray√©es‚Äù, c‚Äôest-√†-dire avec deux couleurs altern√©es  
- `display` : pour l‚Äôensemble stripe, hover, row-border et order-column  
  
```{r}
# changer l'apparence
iris  |>
  datatable(class = "cell-border compact display")
```
  
## Coder en `HTML` pour modifier l'apparence des cellules  
Si les tables produites sont toujours en format `html`, il est aussi possible d'utiliser le code `html` d√®s la cr√©ation.  
  
```{r}
matable <- data.frame(
  c('<b>Bold</b>', '<em>Emphasize</em>'), 
  c('<a href="http://rstudio.com">RStudio</a>',
    '<a href="#" onclick="alert(\'Hello World\');">Hello</a>'
  ))

colnames(matable) <- c('<span style="color:red">Column 1</span>', '<em>Column 2</em>')

matable |> 
  datatable(escape = FALSE) 

```
  
## Interagir avec les donn√©es  
Le package `{DT}` laisse la possibilit√© de modifier les donn√©es gr√¢ce √† l'argument `editable`.  
  
::: {.callout-important}
Les donn√©es ne sont modifi√©es que dans l'interface utilisateur, cela ne modifie pas les donn√©es dans le `server` !  
:::

```{r}
iris |> 
  datatable(
    options = list(pageLength = 5), 
    # editable = "row" 
    editable = "cell"
  )
```

Les donn√©es sont t√©l√©chargeables par l'utilisateur.trice gr√¢ce √† l'argument `buttons`.  
  
```{r interaction_dt}
iris |> 
  datatable(rownames = FALSE, 
            extensions = c("Buttons"),
            options = list(
              dom = "Bfrtip", 
              pageLength = 5,
              buttons = c(
                'copy', 'csv', 'excel', 'pdf', 'print'
              )
            )
  )

# s√©lection des lignes √† enregistrer
iris |> 
  datatable(rownames = FALSE, 
            extensions = c("Buttons", "Select"),
            options = list(
              dom = "Bfrtip", 
              pageLength = 5,
              select = list(style = 'os', items = 'row'),
              buttons = c(
                'copy', 'csv', 'excel', 'pdf', 'print',
                # selection des elements
                'selectAll', 'selectNone', 'selectRows'
              )
            )
  )

```
  

  
# Int√©grer une table scientifique  
## `{flextable}`  
::: {.callout-tip}
## `{flextable}`  

Le [package `{flextable}`](https://ardata-fr.github.io/flextable-book/) permet de r√©aliser des tables facilement int√©grable √† une publication scientifique.  
Ces tables peuvent-√™tre jointes √† un rapport `html` ou un manuscrit `docx` gr√¢ce √† `Quarto` ou encore dans une appli `Shiny`.   

:::  
  
::: {.callout-warning}  
##  Utilisation avec le format `PDF`  
  
Les tables du packages `{flextable}` peuvent normalement √™tre int√©grer dans un `PDF` mais il faut utiliser l'option `latex_engine: xelatex` dans l'en-t√™te `YAML` mais √ßa n'a pas fonctionn√© sur mon ordinateur üò¨  
Du coup je botte en touche pour le moment, je mettrais une mise √† jour quand j'aurais trouv√© mon erreur.  
:::  
  
```{r}
library(flextable)
```

  
Beaucoup d'exemples sont disponible dans la [galerie](https://ardata.fr/en/flextable-gallery/).  
  
```{r}
iris |> 
  flextable()
```
  
::: callout-warning 
## Attention  

Contrairement au package `{DT}` il n'y a pas de navigation dans la table donc l'int√©gralit√© est affich√© !  
Pour l'exemple, nous allons utiliser la fonction `slice_sample()` du package `{dplyr}` pour s√©lectionner un nombre al√©atoire de lignes (ici `n = 10`).  
:::  
  
```{r}
iris_echantillon <- iris |> 
  dplyr::slice_sample(n = 10)

iris_echantillon |> flextable()
```

  
## Modifier une table  
En ajoutant un titre  
```{r}
#| tbl-cap: "10 lignes al√©atoire du jeu de donn√©es iris"
#| echo: fenced

iris_echantillon |> 
  flextable()
```
  
En ajoutant un titre pour plusieurs colonnes  
```{r}
#| tbl-cap: "10 lignes al√©atoire du jeu de donn√©es iris"
#| echo: fenced

iris_echantillon |> 
  flextable() |> 
  separate_header()
```
  
Modifier le th√®me g√©n√©ral  
```{r}
#| tbl-cap: "10 lignes al√©atoire du jeu de donn√©es iris"
#| echo: fenced

iris_echantillon |> 
  flextable() |> 
  separate_header() |> 
  theme_vanilla()
```

Ajouter un ligne de pied de tableau  
```{r}
#| tbl-cap: "10 lignes al√©atoire du jeu de donn√©es iris"
#| echo: fenced

iris_echantillon |> 
  flextable() |> 
  separate_header() |> 
  theme_vanilla() |> 
  add_footer_lines("Ce tableau est tr√®s beau")
```

Mise en couleur de la ligne du bas et du titre des colonnes   
```{r}
#| tbl-cap: "10 lignes al√©atoire du jeu de donn√©es iris"
#| echo: fenced

iris_echantillon |> 
  flextable() |> 
  separate_header() |> 
  theme_vanilla() |> 
  add_footer_lines("Ce tableau est tr√®s beau") |> 
  color(part = "footer", color = "grey") |> 
  color(part = "header", color = "darkblue")
```

Mise en couleur d'une ligne par rapport √† une valeur  
```{r}
#| tbl-cap: "10 lignes al√©atoire du jeu de donn√©es iris"
#| echo: fenced

iris_echantillon |> 
  flextable() |> 
  separate_header() |> 
  theme_vanilla() |> 
  add_footer_lines("Ce tableau est tr√®s beau") |> 
  color(part = "footer", color = "grey") |> 
  color(part = "header", color = "darkblue") |> 
  color(~ Species == "setosa", color = "darkred")
```

Ajout du gras  
```{r}
#| tbl-cap: "10 lignes al√©atoire du jeu de donn√©es iris"
#| echo: fenced

iris_echantillon |> 
  flextable() |> 
  separate_header() |> 
  theme_vanilla() |> 
  add_footer_lines("Ce tableau est tr√®s beau") |> 
  color(part = "footer", color = "grey") |> 
  color(part = "header", color = "darkblue") |> 
  color(~ Species == "setosa", color = "darkred") |> 
  bold(~ Species == "setosa", ~ Species)
```

# Ajout de lien hypertexte vers une table  
## Table g√©n√©r√©e dans un chinck  
Si la table est g√©n√©r√©e dans un chunck, il faut nommer le chunck en commencant par `tbl-` comme ceci :  
  
```{r}
#| echo: fenced
#| label: tbl-iris_flextable  
#| tbl-cap: "10 lignes al√©atoire du jeu de donn√©es iris"

iris_echantillon |> 
  flextable() |> 
  separate_header() |> 
  theme_vanilla() |> 
  add_footer_lines("Ce tableau est tr√®s beau") |> 
  color(part = "footer", color = "grey") |> 
  color(part = "header", color = "darkblue") |> 
  color(~ Species == "setosa", color = "darkred") |> 
  bold(~ Species == "setosa", ~ Species)
```
  
Pour l'appeler dans le texte il suffit d'utiliser `@tbl-nom_du_chunck` comme ceci @tbl-iris_flextable cod√© `@tbl-iris_flextable`  
  
## Table en `Markdown`  
Si la table est cr√©√©e *√† la main* comme ceci 
```
| D√©faut | Gauche | Droite | Centre |
|---------|:-----|------:|:------:|
| 12      | 12   |    12 |   12   |
| 123     | 123  |   123 |  123   |
| 1       | 1    |     1 |   1    |

: Table exemple en Markdown  
```
  
| D√©faut | Gauche | Droite | Centre |
|---------|:-----|------:|:------:|
| 12      | 12   |    12 |   12   |
| 123     | 123  |   123 |  123   |
| 1       | 1    |     1 |   1    |

: Table exemple en Markdown    

Il suffit de rajout `{#tbl-nom_de_la_table}` √† la suite du titre (ligne qui commence par `:`) cod√© comme ceci  
  
```
| D√©faut | Gauche | Droite | Centre |
|---------|:-----|------:|:------:|
| 12      | 12   |    12 |   12   |
| 123     | 123  |   123 |  123   |
| 1       | 1    |     1 |   1    |

: Table exemple en Markdown {#tbl-expl}  
```

| D√©faut | Gauche | Droite | Centre |
|---------|:-----|------:|:------:|
| 12      | 12   |    12 |   12   |
| 123     | 123  |   123 |  123   |
| 1       | 1    |     1 |   1    |

: Table exemple en Markdown {#tbl-expl}  

Puis d'utiliser la m√™me ancre `@tbl-nom_de_la_table` comme ceci @tbl-expl cod√© `@tbl-expl`   
   
# Int√©grer une partie en fonction du type de support  
Imaginez, vous voulez avoir une partie de votre support seulement si vous √™tes dans un type particulier de format.  
  
Pour cela il faut encadrer la section comme cela :   
```
:::{.content-visible when-format="html"}
Ceci n'est visible que si le format de sortie est html.  
:::  
```

:::{.content-visible when-format="html"}
Ceci n'est visible que si le format de sortie est html.  
:::  

