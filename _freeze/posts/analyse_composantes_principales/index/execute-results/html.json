{
  "hash": "18028bdc72912f04b1b2074766aa24df",
  "result": {
    "markdown": "---\ntitle: \"Analyse en Composantes Principales\"\nauthor: \"Marie Vaugoyeau\"\ndate: \"2023/01/10\"\ndate-format: \"D MMMM YYYY\"\ncategories: [twitch, Rnewbies, analyse de données, statistiques]\ntoc: true\ntoc-title: Sur cette page\n---\n\n\n[![](coucher_soleil.png){fig-align=\"center\"}](https://500px.com/p/antoinemach?view=photos)\n\n::: {.callout-note icon=\"false\"}\n[**Twitch du 10 janvier 2023**](https://www.twitch.tv/videos/1703222868).\\\nCode disponible sur [GitHub](https://github.com/Vaugoyeau/twitch_acp).\n:::\n\n\n\n\n\n# Analyse factorielle\n\nSi l'analyse factorielle dont l'ACP fait partie commence son histoire avec la parution de l'article de Karl Pearson *On lines and planes of closest fit to systems of points in space* dans *Philosophical Magazine*, c'est le développement de l'informatique qui lui permet de prendre son essor.\\\nC'est une équipe française menée par Jean-Paul Benzécri qui a mis au point l'analyse factorielle des correspondances dans les années 1960.\\\nIncontournable dans de nombreux domaines, elle permet de **réduire le nombre de variables**, de **connaître les liens entre les variables et/ou les individus**, de **qualifier des groupes d'individus**.\n\nElle est particulièrement utilisée en France.\n\nLes analyses factorielles se réalisent toujours sur un jeu de données rectangulaire avec les individus en lignes (*k lignes*) et les mesures en colonnes (*n colonnes*).\n\n::: {.callout-warning icon=\"false\"}\nUne seule ligne par individus !\n:::\n\nLes *k* individus sont vus dans *n* dimensions.\n\n3 grands types d'analyses factorielles :\\\n\\_ ACP, Analyse en Composantes Principales : que des variables **quantitatives**\\\n\\_ AF(D)M, Analyse Factorielle (des Données) Mixtes : variables **quantitatives** et **qualitatives**\\\n\\_ A(F)CM, Analyse (Factorielle) des Correspondances Multiples : variables **qualitatives** uniquement\n\n# Les données : les pingouins de Palmer\n\nJeu de données extrait du [package `{palmerpenguins}`](https://allisonhorst.github.io/palmerpenguins/) qui est une alternative au jdd `iris`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nlibrary(tidyverse)\nlibrary(tourr)\n\npenguins\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 334 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n\n```{.r .cell-code}\npingouin <- penguins %>% \n  select(- sex) %>% \n  drop_na()\n\npingouin %>% \n  count(species, island)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 3\n  species   island        n\n  <fct>     <fct>     <int>\n1 Adelie    Biscoe       44\n2 Adelie    Dream        56\n3 Adelie    Torgersen    51\n4 Chinstrap Dream        68\n5 Gentoo    Biscoe      123\n```\n:::\n\n```{.r .cell-code}\npingouin %>% \n  group_by(species) %>% \n  summarize(\n    across(where(is.numeric),\n            mean\n    )\n  ) %>% \n  ungroup()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 6\n  species   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g  year\n  <fct>              <dbl>         <dbl>             <dbl>       <dbl> <dbl>\n1 Adelie              38.8          18.3              190.       3701. 2008.\n2 Chinstrap           48.8          18.4              196.       3733. 2008.\n3 Gentoo              47.5          15.0              217.       5076. 2008.\n```\n:::\n\n```{.r .cell-code}\nanimate(\n  data = pingouin %>% \n    select(-island, -species),\n  display = display_xy(col = pingouin$species)\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/tour_horizon_pingouins-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/tour_horizon_pingouins-2.png){width=672}\n:::\n:::\n\n\nVisualisation en utilisant le [package `{tourr}`](http://ggobi.github.io/tourr/articles/tourr.html) qui permet de visuliser le nuage des *k* individus dans les *n* dimensions, ici 342 pingouins dans 5 dimensions.\n\n# ACP sans variables supplémentaires\n\nUtilisation du [package `{FactoMineR}`](http://factominer.free.fr/) pour réaliser les analyses factorielles.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(FactoMineR)\n\nacp_simple <- pingouin %>% \n  select(- species, - island) %>% \n  PCA()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/acp_simple-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/acp_simple-2.png){width=672}\n:::\n\n```{.r .cell-code}\nacp_simple$eig\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 2.77008681              55.401736                          55.40174\ncomp 2 0.99348866              19.869773                          75.27151\ncomp 3 0.77191746              15.438349                          90.70986\ncomp 4 0.36520940               7.304188                          98.01405\ncomp 5 0.09929767               1.985953                         100.00000\n```\n:::\n\n```{.r .cell-code}\ndimdesc(acp_simple)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$Dim.1\n\nLink between the variable and the continuous variables (R-square)\n=================================================================================\n                  correlation       p.value\nflipper_length_mm   0.9585908 1.552310e-187\nbody_mass_g         0.9054051 1.493199e-128\nbill_length_mm      0.7526986  1.089066e-63\nyear                0.1592763  3.140610e-03\nbill_depth_mm      -0.6629540  1.173808e-44\n\n$Dim.2\n\nLink between the variable and the continuous variables (R-square)\n=================================================================================\n            correlation       p.value\nyear          0.9856765 6.531669e-265\nbody_mass_g  -0.1110509  4.011874e-02\n\n$Dim.3\n\nLink between the variable and the continuous variables (R-square)\n=================================================================================\n               correlation      p.value\nbill_depth_mm    0.7027357 3.289288e-52\nbill_length_mm   0.5208740 3.532738e-25\n```\n:::\n\n```{.r .cell-code}\nlibrary(factoextra)\nfviz_screeplot(acp_simple, addlabels = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/acp_simple-3.png){width=672}\n:::\n:::\n\n\n# ACP avec `species` et `island` comme variables supplémentaires\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacp <- PCA(\n  X = pingouin %>% \n    select(-island),\n  quali.sup = 1\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/acp_var_supp-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/acp_var_supp-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot.PCA(acp, choix = \"ind\", habillage = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/acp_var_supp-3.png){width=672}\n:::\n\n```{.r .cell-code}\nacp_annee <-\n  PCA(\n    X = pingouin %>% select(-island),\n    quali.sup = 1,\n    quanti.sup = 6\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/acp_var_supp-4.png){width=672}\n:::\n\n```{.r .cell-code}\nacp_annee$eig\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1  2.7537551              68.843878                          68.84388\ncomp 2  0.7725168              19.312919                          88.15680\ncomp 3  0.3652359               9.130898                          97.28769\ncomp 4  0.1084922               2.712305                         100.00000\n```\n:::\n\n```{.r .cell-code}\nplot.PCA(acp_annee, choix = \"ind\", habillage = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/acp_var_supp-5.png){width=672}\n:::\n\n```{.r .cell-code}\nplotellipses(acp_annee, keepvar = \"species\", label = \"none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/acp_var_supp-6.png){width=672}\n:::\n:::\n\n\n# Remplacement des valeurs manquantes\n\nUtilisation du [package `missMDA`](http://factominer.free.fr/missMDA/index_fr.html) pour le remplacement des valeurs manquantes (uniquement numériques ici).\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>% \n  filter(is.na(bill_depth_mm))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 8\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n1 Adelie  Torgersen             NA            NA                NA          NA\n2 Gentoo  Biscoe                NA            NA                NA          NA\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n\n```{.r .cell-code}\npingouin_vm <- penguins %>% \n  select(bill_length_mm:body_mass_g, year)\n\nlibrary(missMDA)\nn <- estim_ncpPCA(pingouin_vm)\n\npingouin_vm_complete <- MIPCA(pingouin_vm, ncp = n$ncp)\n```\n:::\n\n\nPour afficher les graphiques, il faut utiliser la fonction `plot.MIPCA()`.\n\n\n\n\n\nPour obtenir un jeu de données complet, il suffit de concatener les colonnes non utilisées et celles complétées.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouin_complete <- \n  bind_cols(\n    penguins %>% select(species, island),\n    pingouin_vm_complete[[\"res.imputePCA\"]]\n  )\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}